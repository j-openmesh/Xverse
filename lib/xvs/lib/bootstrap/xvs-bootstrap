#! /usr/bin/env nix-shell
#! nix-shell -i bash -p bash -p gnumake

set -e
set -u
set -x
__XVS_SYSTEM_BOOTSTRAP_BUILDER_PATH="$(which make)"

__XVS_SYSTEM_BOOTSTRAP_BUILDER_PROGRAM_PATH="${__XVS_PROJECT_PATH}/Makefile"

if [[ $# -ge 1 ]]
then
  exec "${__XVS_SYSTEM_BOOTSTRAP_BUILDER_PATH}" -s -f "${__XVS_SYSTEM_BOOTSTRAP_BUILDER_PROGRAM_PATH}" -C "${__XVS_PROJECT_PATH}" "${1}"
else
  exec "${__XVS_SYSTEM_BOOTSTRAP_BUILDER_PATH}" -s -f "${__XVS_SYSTEM_BOOTSTRAP_BUILDER_PROGRAM_PATH}" -C "${__XVS_PROJECT_PATH}"
fi
