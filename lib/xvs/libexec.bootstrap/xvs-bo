#! /usr/bin/env sh

set -e
set -u

if [ ! ${__XVS_RUNTIME_STATE-inactive} == "active" ]; then
  __XVS_PROJECT_BOOTSTRAP_DIR_LIBEXEC_PATH="$(cd "$(dirname "$(readlink "$0" || echo "$0")")" && pwd)"
  __XVS_PROJECT_DIR_PATH="${__XVS_PROJECT_BOOTSTRAP_DIR_LIBEXEC_PATH}/.."
  __XVS_PROJECT_DIR_BIN_NAME="bin"
  __XVS_PROJECT_DIR_BIN_PATH=${__XVS_PROJECT_DIR_PATH}/${__XVS_PROJECT_DIR_BIN_NAME}
  exec ${__XVS_PROJECT_DIR_BIN_PATH}/xvs system bootstrap $@
fi

exit 1

if [ ${_XVS_PROFILE_NAME} -eq "development" || ! -f ${__XVS_TARGET_XVS_SYSTEM_CONTROL_BOOTSTRAP_FLAG_PATH} ]; then
exec ${__XVS_PROJECT_BOOTSTRAP_LIBEXEC_PATH}/${_XVS_SYSTEM_BOOTSTRAP_COMMAND} ${__XVS_RUNTIME_STATE_EXECUTED_EXECUTABLE_NAME} $@
fi

__XVS_RUNTIME_STATE_EXECUTED_EXECUTABLE_NAME="$(basename ${0})"
exec ${__XVS_PROJECT_LIBEXEC_PATH}/${__XVS_RUNTIME_STATE_EXECUTED_EXECUTABLE_NAME} $@





__XVS_SYSTEM_BOOTSTRAP_CACHE_PATH="$(which make)"
__XVS_SYSTEM_BOOTSTRAP_BUILDER_PROGRAM_PATH="${__XVS_PROJECT_PATH}/Makefile"

if [[ $# -ge 1 ]]
then
  exec "${__XVS_SYSTEM_BOOTSTRAP_BUILDER_PATH}" -s -f "${__XVS_SYSTEM_BOOTSTRAP_BUILDER_PROGRAM_PATH}" -C "${__XVS_PROJECT_PATH}" "${1}"
else
  exec "${__XVS_SYSTEM_BOOTSTRAP_BUILDER_PATH}" -s -f "${__XVS_SYSTEM_BOOTSTRAP_BUILDER_PROGRAM_PATH}" -C "${__XVS_PROJECT_PATH}"
fi
